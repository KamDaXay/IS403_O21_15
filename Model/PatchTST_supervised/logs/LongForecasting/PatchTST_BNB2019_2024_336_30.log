Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='BNB2019_2024_336_30', model='PatchTST', data='custom', root_path='./dataset/', data_path='BNB2019_2024.csv', features='MS', target='Close', freq='d', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=30, fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=7, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=True, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=20, learning_rate=0.0001, des='Exp', loss='mse', lradj='TST', pct_start=0.4, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use CPU
>>>>>>>start training : BNB2019_2024_336_30_PatchTST_custom_ftMS_sl336_ll48_pl30_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 905
val 153
test 334
Epoch: 1 cost time: 49.02581524848938
Epoch: 1, Steps: 7 | Train Loss: 0.7858269 Vali Loss: 0.1655286 Test Loss: 0.0602543
Validation loss decreased (inf --> 0.165529).  Saving model ...
Updating learning rate to 4.149030033880619e-06
Epoch: 2 cost time: 63.66830515861511
Epoch: 2, Steps: 7 | Train Loss: 0.7521454 Vali Loss: 0.1574068 Test Loss: 0.0595617
Validation loss decreased (0.165529 --> 0.157407).  Saving model ...
Updating learning rate to 4.59519472089752e-06
Epoch: 3 cost time: 43.15225148200989
Epoch: 3, Steps: 7 | Train Loss: 0.7113354 Vali Loss: 0.1375415 Test Loss: 0.0586264
Validation loss decreased (0.157407 --> 0.137541).  Saving model ...
Updating learning rate to 5.335723563616455e-06
Epoch: 4 cost time: 40.37463307380676
Epoch: 4, Steps: 7 | Train Loss: 0.6635424 Vali Loss: 0.1188662 Test Loss: 0.0573188
Validation loss decreased (0.137541 --> 0.118866).  Saving model ...
Updating learning rate to 6.366018185432408e-06
Epoch: 5 cost time: 40.405951261520386
Epoch: 5, Steps: 7 | Train Loss: 0.6075909 Vali Loss: 0.0929053 Test Loss: 0.0557015
Validation loss decreased (0.118866 --> 0.092905).  Saving model ...
Updating learning rate to 7.679680884578881e-06
Epoch: 6 cost time: 41.084311723709106
Epoch: 6, Steps: 7 | Train Loss: 0.5707960 Vali Loss: 0.0718640 Test Loss: 0.0537769
Validation loss decreased (0.092905 --> 0.071864).  Saving model ...
Updating learning rate to 9.268554361199123e-06
Epoch: 7 cost time: 36.914761543273926
Epoch: 7, Steps: 7 | Train Loss: 0.5111731 Vali Loss: 0.0568733 Test Loss: 0.0516448
Validation loss decreased (0.071864 --> 0.056873).  Saving model ...
Updating learning rate to 1.1122772370790975e-05
Epoch: 8 cost time: 36.868565797805786
Epoch: 8, Steps: 7 | Train Loss: 0.4693498 Vali Loss: 0.0459442 Test Loss: 0.0493797
Validation loss decreased (0.056873 --> 0.045944).  Saving model ...
Updating learning rate to 1.3230820989488083e-05
Epoch: 9 cost time: 37.55918526649475
Epoch: 9, Steps: 7 | Train Loss: 0.4182042 Vali Loss: 0.0412922 Test Loss: 0.0470294
Validation loss decreased (0.045944 --> 0.041292).  Saving model ...
Updating learning rate to 1.5579610110746044e-05
Epoch: 10 cost time: 36.854726791381836
Epoch: 10, Steps: 7 | Train Loss: 0.3825686 Vali Loss: 0.0426349 Test Loss: 0.0445930
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.8154554729468188e-05
Epoch: 11 cost time: 36.83757185935974
Epoch: 11, Steps: 7 | Train Loss: 0.3544190 Vali Loss: 0.0459472 Test Loss: 0.0417970
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.0939665508830835e-05
Epoch: 12 cost time: 36.79721760749817
Epoch: 12, Steps: 7 | Train Loss: 0.3257058 Vali Loss: 0.0471254 Test Loss: 0.0386100
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.391764806742524e-05
Epoch: 13 cost time: 36.72695183753967
Epoch: 13, Steps: 7 | Train Loss: 0.3040301 Vali Loss: 0.0459632 Test Loss: 0.0351120
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.7070010370184607e-05
Epoch: 14 cost time: 36.79195308685303
Epoch: 14, Steps: 7 | Train Loss: 0.2801069 Vali Loss: 0.0436492 Test Loss: 0.0314888
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.03771775562429e-05
Epoch: 15 cost time: 36.795939207077026
Epoch: 15, Steps: 7 | Train Loss: 0.2629273 Vali Loss: 0.0402123 Test Loss: 0.0283127
Validation loss decreased (0.041292 --> 0.040212).  Saving model ...
Updating learning rate to 3.381861349069235e-05
Epoch: 16 cost time: 38.760836124420166
Epoch: 16, Steps: 7 | Train Loss: 0.2419947 Vali Loss: 0.0406291 Test Loss: 0.0257052
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.7372948285453424e-05
Epoch: 17 cost time: 38.774189949035645
Epoch: 17, Steps: 7 | Train Loss: 0.2272087 Vali Loss: 0.0383584 Test Loss: 0.0238912
Validation loss decreased (0.040212 --> 0.038358).  Saving model ...
Updating learning rate to 4.1018110997405826e-05
Epoch: 18 cost time: 38.68765687942505
Epoch: 18, Steps: 7 | Train Loss: 0.2118562 Vali Loss: 0.0401545 Test Loss: 0.0225615
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.473146667978032e-05
Epoch: 19 cost time: 38.224406719207764
Epoch: 19, Steps: 7 | Train Loss: 0.1973507 Vali Loss: 0.0434080 Test Loss: 0.0217493
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.8489956935778755e-05
Epoch: 20 cost time: 38.61373949050903
Epoch: 20, Steps: 7 | Train Loss: 0.1838870 Vali Loss: 0.0413687 Test Loss: 0.0209050
EarlyStopping counter: 3 out of 20
Updating learning rate to 5.227024310164316e-05
Epoch: 21 cost time: 38.34488272666931
Epoch: 21, Steps: 7 | Train Loss: 0.1706706 Vali Loss: 0.0451882 Test Loss: 0.0198816
EarlyStopping counter: 4 out of 20
Updating learning rate to 5.604885117006615e-05
Epoch: 22 cost time: 38.37912368774414
Epoch: 22, Steps: 7 | Train Loss: 0.1600189 Vali Loss: 0.0456177 Test Loss: 0.0190112
EarlyStopping counter: 5 out of 20
Updating learning rate to 5.9802317554028626e-05
Epoch: 23 cost time: 38.57632303237915
Epoch: 23, Steps: 7 | Train Loss: 0.1537874 Vali Loss: 0.0460976 Test Loss: 0.0184734
EarlyStopping counter: 6 out of 20
Updating learning rate to 6.350733478593175e-05
Epoch: 24 cost time: 38.6062376499176
Epoch: 24, Steps: 7 | Train Loss: 0.1464986 Vali Loss: 0.0480185 Test Loss: 0.0174743
EarlyStopping counter: 7 out of 20
Updating learning rate to 6.714089624729227e-05
Epoch: 25 cost time: 39.27002763748169
Epoch: 25, Steps: 7 | Train Loss: 0.1427870 Vali Loss: 0.0501154 Test Loss: 0.0165051
EarlyStopping counter: 8 out of 20
Updating learning rate to 7.068043903028957e-05
Epoch: 26 cost time: 38.68375301361084
Epoch: 26, Steps: 7 | Train Loss: 0.1296900 Vali Loss: 0.0527938 Test Loss: 0.0158144
EarlyStopping counter: 9 out of 20
Updating learning rate to 7.410398404405401e-05
Epoch: 27 cost time: 38.59361243247986
Epoch: 27, Steps: 7 | Train Loss: 0.1336161 Vali Loss: 0.0587893 Test Loss: 0.0150652
EarlyStopping counter: 10 out of 20
Updating learning rate to 7.739027249569418e-05
Epoch: 28 cost time: 38.37909483909607
Epoch: 28, Steps: 7 | Train Loss: 0.1274941 Vali Loss: 0.0648373 Test Loss: 0.0146872
EarlyStopping counter: 11 out of 20
Updating learning rate to 8.051889789857308e-05
Epoch: 29 cost time: 39.05971121788025
Epoch: 29, Steps: 7 | Train Loss: 0.1213550 Vali Loss: 0.0565176 Test Loss: 0.0138504
EarlyStopping counter: 12 out of 20
Updating learning rate to 8.347043278811605e-05
Epoch: 30 cost time: 38.29409742355347
Epoch: 30, Steps: 7 | Train Loss: 0.1280820 Vali Loss: 0.0665632 Test Loss: 0.0137948
EarlyStopping counter: 13 out of 20
Updating learning rate to 8.622654935829858e-05
Epoch: 31 cost time: 38.86279487609863
Epoch: 31, Steps: 7 | Train Loss: 0.1224418 Vali Loss: 0.0577706 Test Loss: 0.0127964
EarlyStopping counter: 14 out of 20
Updating learning rate to 8.877013326971095e-05
Epoch: 32 cost time: 38.65721011161804
Epoch: 32, Steps: 7 | Train Loss: 0.1148391 Vali Loss: 0.0580132 Test Loss: 0.0119885
EarlyStopping counter: 15 out of 20
Updating learning rate to 9.108538992249917e-05
Epoch: 33 cost time: 39.1311092376709
Epoch: 33, Steps: 7 | Train Loss: 0.1109863 Vali Loss: 0.0674163 Test Loss: 0.0124219
EarlyStopping counter: 16 out of 20
Updating learning rate to 9.315794253427126e-05
Epoch: 34 cost time: 38.55070662498474
Epoch: 34, Steps: 7 | Train Loss: 0.1090128 Vali Loss: 0.0583088 Test Loss: 0.0119759
EarlyStopping counter: 17 out of 20
Updating learning rate to 9.497492141394589e-05
Epoch: 35 cost time: 38.24876284599304
Epoch: 35, Steps: 7 | Train Loss: 0.1048674 Vali Loss: 0.0585060 Test Loss: 0.0116162
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.65250438771898e-05
Epoch: 36 cost time: 38.73044037818909
Epoch: 36, Steps: 7 | Train Loss: 0.1067478 Vali Loss: 0.0523875 Test Loss: 0.0114951
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.779868430720235e-05
Epoch: 37 cost time: 38.9708034992218
Epoch: 37, Steps: 7 | Train Loss: 0.1120158 Vali Loss: 0.0493088 Test Loss: 0.0110968
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : BNB2019_2024_336_30_PatchTST_custom_ftMS_sl336_ll48_pl30_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 334
rmse: 0.15456785261631012, mse:0.02389122173190117, mape: 0.490327388048172, mae:0.12334106117486954, rse:0.6951586604118347, mspe: 0.4554767608642578, corr: [0.13061838 0.12957478 0.13325116 0.12868533 0.12374282 0.12721083
 0.13134289 0.1280463  0.1303736  0.12286481 0.12720744 0.12301871
 0.12361725 0.12602298 0.11244114 0.11969519 0.1206931  0.12124676
 0.12559229 0.1163662  0.12245288 0.11978533 0.11166791 0.11851268
 0.11598271 0.12021702 0.11663277 0.11765606 0.11756599 0.11702995]
>>>>>>>predicting : BNB2019_2024_336_30_PatchTST_custom_ftMS_sl336_ll48_pl30_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
pred 1
