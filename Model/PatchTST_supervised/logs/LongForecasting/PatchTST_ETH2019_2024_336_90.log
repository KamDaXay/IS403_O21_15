Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ETH2019_2024_336_90', model='PatchTST', data='custom', root_path='./dataset/', data_path='ETH2019_2024.csv', features='MS', target='Close', freq='d', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=90, fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=7, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=True, num_workers=10, itr=1, train_epochs=1, batch_size=128, patience=20, learning_rate=0.0001, des='Exp', loss='mse', lradj='TST', pct_start=0.4, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use CPU
>>>>>>>start training : ETH2019_2024_336_90_PatchTST_custom_ftMS_sl336_ll48_pl90_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 845
val 93
test 274
Epoch: 1 cost time: 45.19114303588867
Epoch: 1, Steps: 6 | Train Loss: 0.7811524 Vali Loss: nan Test Loss: 0.0495392
Validation loss decreased (inf --> nan).  Saving model ...
Updating learning rate to 1.7860948073195e-05
>>>>>>>testing : ETH2019_2024_336_90_PatchTST_custom_ftMS_sl336_ll48_pl90_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 274
rmse: 0.222573921084404, mse:0.04953915253281593, mape: 0.49230626225471497, mae:0.18156729638576508, rse:1.5744459629058838, mspe: 0.32117682695388794, corr: [-0.06855016 -0.0278167  -0.00787148 -0.02411432 -0.04027179 -0.04148746
 -0.02453132 -0.05744014  0.00931723 -0.04942755 -0.03062143 -0.0598641
 -0.01659663 -0.02136775 -0.04184376 -0.01105295 -0.01864708 -0.03473748
 -0.05775784 -0.06757775 -0.04053894 -0.04018986 -0.06745645 -0.06299151
 -0.03129685 -0.06167197 -0.06137983 -0.06586102 -0.05039912 -0.03605747
 -0.03500758 -0.00614344 -0.05905236 -0.07434275 -0.07655491 -0.02853221
 -0.01234771  0.00359626 -0.06175762 -0.08712428 -0.02127436 -0.04997208
 -0.03457229 -0.0620574   0.01130377 -0.03912809 -0.03971985 -0.0035648
 -0.01483923 -0.00339674 -0.05519998 -0.00834855 -0.01323212 -0.07839613
  0.01946597 -0.04851061 -0.03021636 -0.03641876 -0.01740439  0.03547893
  0.03647054 -0.00862574 -0.05689631 -0.01998671 -0.03540361 -0.01009555
 -0.01353913 -0.02633664 -0.00507835 -0.03953357 -0.06112497  0.01151991
 -0.07279151  0.05779188  0.07787945 -0.04840929 -0.03568128  0.00833271
 -0.00411369  0.01405101  0.04061462  0.03751048  0.05212941  0.04103944
 -0.08105405 -0.04318788  0.05464317 -0.08537682  0.06842156  0.06816799]
>>>>>>>predicting : ETH2019_2024_336_90_PatchTST_custom_ftMS_sl336_ll48_pl90_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
pred 1
